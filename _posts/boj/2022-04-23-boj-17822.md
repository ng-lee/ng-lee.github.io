---
title: '[ë°±ì¤€/Gold3] 17822 ì›íŒ ëŒë¦¬ê¸° - íŒŒì´ì¬'
date: 2022-04-23 22:36:00 +0900
categories: [Baekjoon]
tags: [baekjoon, gold3, êµ¬í˜„, ì‹œë®¬ë ˆì´ì…˜]
math: true
mermaid: true
---

![](/assets/images/banners/baekjoon_banner.png){: style="max-width: 100%"}

## [ë¬¸ì œ í™•ì¸í•˜ê¸° â”](https://www.acmicpc.net/problem/17822){:target="_blank"}

## â­ï¸ ë‚˜ì˜ í’€ì´

ì¼ë‹¨ ì£¼ì˜ì ì€ í•˜ë‚˜ì˜ ì›íŒì— ìˆì„ ìˆ˜ ìˆëŠ” ìˆ«ìë“¤ì˜ ê°¯ìˆ˜ëŠ” 4ê°œê°€ ì•„ë‹Œ `m`ê°œì¸ ì ì„ ì¡°ì‹¬í•˜ì.

ê°ê°ì˜ ì›íŒë“¤ì„ ì¼ì¼íˆ íšŒì „ì‹œí‚¤ëŠ” ê²ƒì€ êµ¬í˜„í•˜ê¸°ë„ ë³µì¡í•˜ê³  ì‹œê°„ë„ ì˜¤ë˜ ê±¸ë¦¬ê¸° ë•Œë¬¸ì— `head`ì— ê°ê°ì˜ ì›íŒë“¤ì˜ ê¸°ì¤€ì ì„ ì €ì¥í–ˆë‹¤.
ì‹œê³„ ë°©í–¥(`k`ê°€ 0ì¸ ê²½ìš°)ìœ¼ë¡œ íšŒì „í•˜ëŠ” ê²½ìš°ì—ëŠ” ì¸ë±ìŠ¤ë¥¼ `-k`ë§Œí¼ ì´ë™ì‹œì¼œì•¼ í•˜ê³ , ë°˜ì‹œê³„ ë°©í–¥(`k`ê°€ 1ì¸ ê²½ìš°)ì¸ ê²½ìš°ì—ëŠ” `+k`ë§Œí¼ ì´ë™ì‹œì¼œì•¼ í•˜ê¸° ë•Œë¬¸ì— ì¸ë±ìŠ¤ ê³„ì‚°ì„ ë‹¤ìŒê³¼ ê°™ì´ í•˜ì˜€ë‹¤. 

`head[idx] = (head[idx] + k * (2 * d - 1)) % m`

`head` ê³„ì‚°ì´ ëª¨ë‘ ëë‚œ ë‹¤ìŒ, ì „ì²´ ì›íŒì— ëŒ€í•´ì„œ ì¸ì ‘í•œ ìˆ«ìë“¤ì„ í™•ì¸í•´ì•¼ í•œë‹¤.
`target`ì´ë¼ëŠ” ì§‘í•©ì„ ë§Œë“¤ì—ˆëŠ”ë°, ì§‘í•©ì„ ì„ íƒí•œ ì´ìœ ëŠ” 3ê°œ ì´ìƒ ì—°ì†ìœ¼ë¡œ ì¸ì ‘í•œ ìˆ«ìê°€ ìˆëŠ” ê²½ìš°ì—ëŠ” ì¤‘ë³µì„ í”¼í•˜ê¸° ìœ„í•´ì„œ ì´ë‹¤.
ì˜ˆì œ ì…ë ¥ 4ë¥¼ ë³´ë©´, ì—°ì†ìœ¼ë¡œ ì¸ì ‘í•œ ìˆ«ìë“¤ë„ ëª¨ë‘ ê°™ì´ ì‚­ì œëœë‹¤ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤.

ë¨¼ì € í•˜ë‚˜ì˜ ì›íŒ ì•ˆì—ì„œ 0ì´ ì•„ë‹Œ ì¸ì ‘í•œ ìˆ«ìê°€ ê°™ìœ¼ë©´ `(ì›íŒë²ˆí˜¸, ì¸ë±ìŠ¤)`ì˜ í˜•íƒœë¡œ `target`ì— ë„£ì—ˆë‹¤.
ì‚¬ì‹¤ ì¸ì ‘í•œ ìˆ«ìê°€ 0ìœ¼ë¡œ ê°™ì€ ê²½ìš°ì—ë„ ë„£ì–´ë„ ë˜ëŠ”ë°, êµ³ì´ ì“¸ë°ì—†ëŠ” ì—°ì‚°ì„ í”¼í•˜ê¸° ìœ„í•´ì„œ ì¡°ê±´ë¬¸ì— ë„£ì—ˆë‹¤.
í•˜ë‚˜ì˜ ì›íŒ ìœ„ì—ì„œë„ í‰ê· ê°’ ê³„ì‚°ì— ë”°ë¼ ê°’ì´ ë‹¬ë¼ì§€ê¸° ë•Œë¬¸ì— ì „ì²´ì ì¸ `for`ë¬¸ ë‚´ì—ì„œ ì—°ì‚°ì„ í•´ì•¼ í•œë‹¤. (í•˜ë‚˜ì˜ ì›íŒ ë‚´ì—ì„œëŠ” ì¸ì ‘ ê´€ê³„ê°€ ë³€í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì— `for`ë¬¸ ì•ˆì—ì„œ ì—¬ëŸ¬ ë²ˆ ì—°ì‚° í•˜ëŠ” ê²ƒì´ ì•„ë‹Œ ë°–ì—ì„œ í•œë²ˆë§Œ ì—°ì‚°í•˜ë©´ ëœë‹¤ë¼ê³  ìƒê°í•  ìˆ˜ ìˆì§€ë§Œ ê·¸ë ‡ì§€ ì•Šë‹¤ë¼ëŠ” ëœ»)

ê·¸ ë‹¤ìŒ ê°ê°ì˜ ì›íŒë“¤ì˜ ê¸°ì¤€ì ì—ì„œ í•˜ë‚˜ì”© ëŠ˜ë ¤ê°€ë©´ì„œ í™•ì¸í•˜ì—¬ `target`ì— ë„£ì—ˆë‹¤.
ì—¬ê¸°ì„œ ê¸°ì¤€ì ì—ì„œ í•˜ë‚˜ì”© ëŠ˜ë¦°ë‹¤ëŠ” ëœ»ì€ í•˜ë‚˜ì˜ ì›íŒì—ì„œ ê¸°ì¤€ì ì—ì„œ ê·¸ ë‹¤ìŒ ìˆ«ìë¥¼ ì„ íƒí•œë‹¤ëŠ” ê²ƒì´ë‹¤.

ë§Œì•½, `target`ì— ì•„ë¬´ ìŒë„ ì—†ë‹¤ë©´ ì¡´ì¬í•˜ëŠ” ìˆ«ìë“¤ì˜ í‰ê· ì„ êµ¬í•´ì„œ í‰ê· ë³´ë‹¤ í¬ë©´ 1ì„ ë¹¼ê³  ì‘ìœ¼ë©´ 1ì„ ë”í•˜ëŠ” ì‘ì—…ì„ í•´ì•¼ í•œë‹¤.
ì „ì²´ ì´ì°¨ì› ë°°ì—´ì„ ëŒë©´ì„œ ì´í•©ì„ êµ¬í•˜ê³  íšŸìˆ˜ë¥¼ ì¹´ìš´íŠ¸í•´ì•¼ í•œë‹¤.
ì—¬ê¸°ì„œ ì¡°ì‹¬í•´ì•¼ í•  ì ì€ 0ì¸ ê²½ìš°ê¹Œì§€ íšŸìˆ˜ì— ë”í•˜ë©´ ì•ˆëœë‹¤ëŠ” ê²ƒê³¼, ìˆ«ìê°€ í‰ê· ê³¼ ê°™ì€ ê²½ìš°ì—ëŠ” ì•„ë¬´ê²ƒë„ í•˜ì§€ ì•ŠëŠ”ë‹¤ëŠ” ê²ƒì´ë‹¤. (ì˜ˆì œ ì…ë ¥ 5ë¥¼ í†µí•´ í™•ì¸í•  ìˆ˜ ìˆë‹¤.)
0ì´ ì•„ë‹Œ ìˆ«ìê°€ ì—†ìœ¼ë©´, ë”ì´ìƒì˜ íšŒì „ ë“±ì˜ ì—°ì‚°ì„ í•  í•„ìš”ê°€ ì—†ìœ¼ë‹ˆ `break`ë¬¸ì„ í†µí•´ì„œ ë¹ ì ¸ë‚˜ì™”ë‹¤.

`target`ì— ìŒì´ ìˆë‹¤ë©´, í•˜ë‚˜ì”© êº¼ë‚´ë©´ì„œ í•´ë‹¹ ì›íŒì˜ ì¸ë±ìŠ¤ì— í•´ë‹¹í•˜ëŠ” ìˆ«ìë¥¼ 0ìœ¼ë¡œ ë§Œë“¤ì–´ì£¼ì—ˆë‹¤.

## ì½”ë“œ

```python
import sys

input = sys.stdin.readline


def main():
    n, m, t = map(int, input().split())
    plates = [list(map(int, input().split())) for _ in range(n)]
    ops = [list(map(int, input().split())) for _ in range(t)]

    # ì›íŒì— 4ê°œì˜ ìˆ«ìê°€ ìˆëŠ” ê²½ìš°, 10001ë²ˆ íšŒì „í•˜ëŠ” ê²ƒê³¼ 1ë²ˆ íšŒì „í•˜ëŠ” ê²ƒì€ ê°™ë‹¤.
    for op in ops:
        op[2] = op[2] % m

    # ê°ê°ì˜ ì›íŒì˜ ê¸°ì¤€ì ë“¤ì„ ì €ì¥
    head = [0] * n

    for op in ops:
        x, d, k = op
        for idx in range(n):
            # idxëŠ” 0ë¶€í„° ì‹œì‘í•˜ê¸° ë•Œë¬¸ì— 1ì„ ë”í•˜ì—¬ xì˜ ë°°ìˆ˜ì¸ì§€ í™•ì¸
            if (idx + 1) % x == 0:
                # ê¸°ì¡´ ê¸°ì¤€ì ì—ì„œ dê°€ 0ì¸ ê²½ìš°ì—ëŠ” -k, dê°€ 1ì¸ ê²½ìš°ì—ëŠ” +k ë§Œí¼ ì´ë™í•œë‹¤.
                # í•˜ë‚˜ì˜ ì›íŒì˜ ê¸¸ì´ëŠ” mì´ê¸° ë•Œë¬¸ì— ë²”ìœ„ë¥¼ ë„˜ì§€ ì•Šë„ë¡ í•˜ì.
                head[idx] = (head[idx] + k * (2 * d - 1)) % m
        targets = set()
        # í•˜ë‚˜ì˜ ì›íŒ ìœ„ì—ì„œ í™•ì¸
        for idx in range(n):
            for i in range(m - 1):
                if plates[idx][i] != 0 and plates[idx][i] == plates[idx][i + 1]:
                    targets.add((idx, i))
                    targets.add((idx, i + 1))
            # ë§ˆì§€ë§‰ ì¸ë±ìŠ¤ì— í•´ë‹¹í•˜ëŠ” ìˆ«ìì™€ ì²«ë²ˆì§¸ ì¸ë±ìŠ¤ì— í•´ë‹¹í•˜ëŠ” ìˆ«ìê°€ ê°™ì€ ê²½ìš°
            if plates[idx][m - 1] != 0 and plates[idx][m - 1] == plates[idx][0]:
                targets.add((idx, m - 1))
                targets.add((idx, 0))
        # ì¸ì ‘í•œ ì›íŒë“¤ ì‚¬ì´ì—ì„œ í™•ì¸
        # ì›íŒì— ì´ mê°œì˜ ìˆ«ìê°€ ìˆìœ¼ë©´ ê¸°ì¤€ì ì—ì„œ 0ë¶€í„° m-1ê¹Œì§€ ë–¨ì–´ì§„ ìˆ«ìë“¤ì´ ìˆë‹¤.
        for move in range(m):
            # ê°ê°ì˜ ì›íŒì˜ ê¸°ì¤€ì ì—ì„œ ë–¨ì–´ì§„ ë§Œí¼ì„ ë”í•´ì„œ ì¸ì ‘í•œ ì›íŒì˜ ìˆ«ìë“¤ê³¼ ë¹„êµ
            current = list(map(lambda x: (x + move) % m, head))
            for idx in range(n - 1):
                if (
                    plates[idx][current[idx]] != 0
                    and plates[idx][current[idx]] == plates[idx + 1][current[idx + 1]]
                ):
                    targets.add((idx, current[idx]))
                    targets.add((idx + 1, current[idx + 1]))
        # ì¸ì ‘í•˜ë©´ì„œ ê°™ì€ ìˆ˜ê°€ ì—†ëŠ” ê²½ìš°
        if len(targets) == 0:
            tmp = 0
            cnt = 0
            for i in range(n):
                for j in range(m):
                    if plates[i][j] != 0:
                        tmp += plates[i][j]
                        cnt += 1
            # ëª¨ë‘ 0ì´ë¼ëŠ” ëœ» -> ë”ì´ìƒ ì—°ì‚°ì„ í•  í•„ìš”ê°€ ì—†ë‹¤
            if cnt == 0:
                break
            avg = tmp / cnt
            for i in range(n):
                for j in range(m):
                    if plates[i][j] != 0:
                        if plates[i][j] < avg:
                            plates[i][j] += 1
                        elif plates[i][j] > avg:
                            plates[i][j] -= 1
        # ì¸ì ‘í•˜ë©´ì„œ ê°™ì€ ìˆ˜ì¸ ê²½ìš°ì—ëŠ” 0ìœ¼ë¡œ ë°”ê¾¼ë‹¤.
        else:
            for (i, j) in targets:
                plates[i][j] = 0

    answer = 0
    for plate in plates:
        answer += sum(plate)

    print(answer)


main()
```

> ê³µë¶€ ê¸°ë¡ìš© ë¸”ë¡œê·¸ ì…ë‹ˆë‹¤. ì˜¤ë¥˜ë‚˜ í‹€ë¦° ë¶€ë¶„ ì§€ì í•´ì£¼ì‹œë©´ ê°ì‚¬í•˜ê² ìŠµë‹ˆë‹¤! ğŸ‘
{: .prompt-info }